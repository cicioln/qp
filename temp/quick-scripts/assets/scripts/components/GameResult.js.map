{"version":3,"sources":["GameResult.js"],"names":["cc","Class","extends","Component","properties","_gameresult","_seats","onLoad","vv","node","getChildByName","seats","i","children","length","push","getComponent","btnClose","find","utils","addClickEvent","btnShare","self","on","data","onGameEnd","showResult","seat","info","isZuiJiaPaoShou","active","Label","string","numzimo","numjiepao","numdianpao","numangang","numminggang","numchadajiao","endinfo","gameNetMgr","maxscore","maxdianpao","dianpaogaoshou","score","isBigwin","setInfo","name","setID","userid","onBtnCloseClicked","wc","show","director","loadScene","onBtnShareClicked","anysdkMgr","shareResult"],"mappings":"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","file":"GameResult.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        _gameresult:null,\r\n        _seats:[],\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        if(cc.vv == null){\r\n            return;\r\n        }\r\n        \r\n        this._gameresult = this.node.getChildByName(\"game_result\");\r\n        //this._gameresult.active = false;\r\n        \r\n        var seats = this._gameresult.getChildByName(\"seats\");\r\n        for(var i = 0; i < seats.children.length; ++i){\r\n            this._seats.push(seats.children[i].getComponent(\"Seat\"));   \r\n        }\r\n        \r\n        var btnClose = cc.find(\"Canvas/game_result/btnClose\");\r\n        if(btnClose){\r\n            cc.vv.utils.addClickEvent(btnClose,this.node,\"GameResult\",\"onBtnCloseClicked\");\r\n        }\r\n        \r\n        var btnShare = cc.find(\"Canvas/game_result/btnShare\");\r\n        if(btnShare){\r\n            cc.vv.utils.addClickEvent(btnShare,this.node,\"GameResult\",\"onBtnShareClicked\");\r\n        }\r\n        \r\n        //初始化网络事件监听器\r\n        var self = this;\r\n        this.node.on('game_end',function(data){self.onGameEnd(data);});\r\n    },\r\n    \r\n    showResult:function(seat,info,isZuiJiaPaoShou){\r\n        seat.node.getChildByName(\"zuijiapaoshou\").active = isZuiJiaPaoShou;\r\n        \r\n        seat.node.getChildByName(\"zimocishu\").getComponent(cc.Label).string = info.numzimo;\r\n        seat.node.getChildByName(\"jiepaocishu\").getComponent(cc.Label).string = info.numjiepao;\r\n        seat.node.getChildByName(\"dianpaocishu\").getComponent(cc.Label).string = info.numdianpao;\r\n        seat.node.getChildByName(\"angangcishu\").getComponent(cc.Label).string = info.numangang;\r\n        seat.node.getChildByName(\"minggangcishu\").getComponent(cc.Label).string = info.numminggang;\r\n        seat.node.getChildByName(\"chajiaocishu\").getComponent(cc.Label).string = info.numchadajiao;\r\n    },\r\n    \r\n    onGameEnd:function(endinfo){\r\n        var seats = cc.vv.gameNetMgr.seats;\r\n        var maxscore = -1;\r\n        var maxdianpao = 0;\r\n        var dianpaogaoshou = -1;\r\n        for(var i = 0; i < seats.length; ++i){\r\n            var seat = seats[i];\r\n            if(seat.score > maxscore){\r\n                maxscore = seat.score;\r\n            }\r\n            if(endinfo[i].numdianpao > maxdianpao){\r\n                maxdianpao = endinfo[i].numdianpao;\r\n                dianpaogaoshou = i;\r\n            }\r\n        }\r\n        \r\n        for(var i = 0; i < seats.length; ++i){\r\n            var seat = seats[i];\r\n            var isBigwin = false;\r\n            if(seat.score > 0){\r\n                isBigwin = seat.score == maxscore;\r\n            }\r\n            this._seats[i].setInfo(seat.name,seat.score, isBigwin);\r\n            this._seats[i].setID(seat.userid);\r\n            var isZuiJiaPaoShou = dianpaogaoshou == i;\r\n            this.showResult(this._seats[i],endinfo[i],isZuiJiaPaoShou);\r\n        }\r\n    },\r\n    \r\n    onBtnCloseClicked:function(){\r\n        cc.vv.wc.show('正在返回游戏大厅');\r\n        cc.director.loadScene(\"hall\");\r\n    },\r\n    \r\n    onBtnShareClicked:function(){\r\n        cc.vv.anysdkMgr.shareResult();\r\n    }\r\n});\r\n"]}
{"version":3,"sources":["CreateRoom.js"],"names":["cc","Class","extends","Component","properties","_leixingxuanze","_gamelist","_currentGame","onLoad","node","getChildByName","t","i","childrenCount","n","children","getComponent","push","onBtnBack","active","onBtnOK","usedTypes","type","getType","indexOf","createRoom","length","checked","getSelectedOfRadioGroup","groupRoot","console","log","arr","selected","self","onCreate","ret","errcode","vv","wc","hide","alert","show","gameNetMgr","connectGameServer","conf","constructSCMJConf","data","account","userMgr","sign","JSON","stringify","http","sendRequest","wanfaxuanze","huansanzhang","jiangdui","menqing","tiandihu","difen","zimo","zuidafanshu","jushuxuanze","dianganghua","update","dt","lastType","game"],"mappings":"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","file":"CreateRoom.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        _leixingxuanze: null,\r\n        _gamelist: null,\r\n        _currentGame: null,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n\r\n        this._gamelist = this.node.getChildByName('game_list');\r\n\r\n        this._leixingxuanze = [];\r\n        var t = this.node.getChildByName(\"leixingxuanze\");\r\n        for (var i = 0; i < t.childrenCount; ++i) {\r\n            var n = t.children[i].getComponent(\"RadioButton\");\r\n            if (n != null) {\r\n                this._leixingxuanze.push(n);\r\n            }\r\n        }\r\n    },\r\n\r\n    onBtnBack: function () {\r\n        this.node.active = false;\r\n    },\r\n\r\n    onBtnOK: function () {\r\n        var usedTypes = ['xzdd', 'xlch'];\r\n        var type = this.getType();\r\n        if (usedTypes.indexOf(type) == -1) {\r\n            return;\r\n        }\r\n\r\n        this.node.active = false;\r\n        this.createRoom();\r\n    },\r\n\r\n    getType: function () {\r\n        var type = 0;\r\n        for (var i = 0; i < this._leixingxuanze.length; ++i) {\r\n            if (this._leixingxuanze[i].checked) {\r\n                type = i;\r\n                break;\r\n            }\r\n        }\r\n        if (type == 0) {\r\n            return 'xzdd';\r\n        }\r\n        else if (type == 1) {\r\n            return 'xlch';\r\n        }\r\n        return 'xzdd';\r\n    },\r\n\r\n    getSelectedOfRadioGroup(groupRoot) {\r\n        console.log(groupRoot);\r\n        var t = this._currentGame.getChildByName(groupRoot);\r\n\r\n        var arr = [];\r\n        for (var i = 0; i < t.children.length; ++i) {\r\n            var n = t.children[i].getComponent(\"RadioButton\");\r\n            if (n != null) {\r\n                arr.push(n);\r\n            }\r\n        }\r\n        var selected = 0;\r\n        for (var i = 0; i < arr.length; ++i) {\r\n            if (arr[i].checked) {\r\n                selected = i;\r\n                break;\r\n            }\r\n        }\r\n        return selected;\r\n    },\r\n\r\n    createRoom: function () {\r\n        var self = this;\r\n        var onCreate = function (ret) {\r\n            if (ret.errcode !== 0) {\r\n                cc.vv.wc.hide();\r\n                //console.log(ret.errmsg);\r\n                if (ret.errcode == 2222) {\r\n                    cc.vv.alert.show(\"提示\", \"钻石不足，创建房间失败!\");\r\n                }\r\n                else {\r\n                    cc.vv.alert.show(\"提示\", \"创建房间失败,错误码:\" + ret.errcode);\r\n                }\r\n            }\r\n            else {\r\n                cc.vv.gameNetMgr.connectGameServer(ret);\r\n            }\r\n        };\r\n\r\n        var type = this.getType();\r\n        var conf = null;\r\n        if (type == 'xzdd') {\r\n            conf = this.constructSCMJConf();\r\n        }\r\n        else if (type == 'xlch') {\r\n            conf = this.constructSCMJConf();\r\n        }\r\n        conf.type = type;\r\n\r\n        var data = {\r\n            account: cc.vv.userMgr.account,\r\n            sign: cc.vv.userMgr.sign,\r\n            conf: JSON.stringify(conf)\r\n        };\r\n        console.log(data);\r\n        cc.vv.wc.show(\"正在创建房间\");\r\n        cc.vv.http.sendRequest(\"/create_private_room\", data, onCreate);\r\n    },\r\n\r\n    constructSCMJConf: function () {\r\n\r\n        var wanfaxuanze = this._currentGame.getChildByName('wanfaxuanze');\r\n        var huansanzhang = wanfaxuanze.children[0].getComponent('CheckBox').checked;\r\n        var jiangdui = wanfaxuanze.children[1].getComponent('CheckBox').checked;\r\n        var menqing = wanfaxuanze.children[2].getComponent('CheckBox').checked;\r\n        var tiandihu = wanfaxuanze.children[3].getComponent('CheckBox').checked;\r\n\r\n        var difen = this.getSelectedOfRadioGroup('difenxuanze');\r\n        var zimo = this.getSelectedOfRadioGroup('zimojiacheng');\r\n        var zuidafanshu = this.getSelectedOfRadioGroup('zuidafanshu');\r\n        var jushuxuanze = this.getSelectedOfRadioGroup('xuanzejushu');\r\n        var dianganghua = this.getSelectedOfRadioGroup('dianganghua');\r\n        \r\n        var conf = {\r\n            difen:difen,\r\n            zimo:zimo,\r\n            jiangdui:jiangdui,\r\n            huansanzhang:huansanzhang,\r\n            zuidafanshu:zuidafanshu,\r\n            jushuxuanze:jushuxuanze,\r\n            dianganghua:dianganghua,\r\n            menqing:menqing,\r\n            tiandihu:tiandihu,   \r\n        };\r\n        return conf;\r\n    },\r\n\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n\r\n        var type = this.getType();\r\n        if (this.lastType != type) {\r\n            this.lastType = type;\r\n            for (var i = 0; i < this._gamelist.childrenCount; ++i) {\r\n                this._gamelist.children[i].active = false;\r\n            }\r\n\r\n            var game = this._gamelist.getChildByName(type);\r\n            if (game) {\r\n                game.active = true;\r\n            }\r\n            this._currentGame = game;\r\n        }\r\n    },\r\n});"]}
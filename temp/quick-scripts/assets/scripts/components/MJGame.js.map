{"version":3,"sources":["MJGame.js"],"names":["cc","Class","extends","Component","properties","gameRoot","default","type","Node","prepareRoot","_myMJArr","_options","_selectedMJ","_chupaiSprite","_mjcount","_gamecount","_hupaiTips","_hupaiLists","_playEfxs","_opts","onLoad","vv","utils","setFitSreenMode","addComponent","initView","initEventHandlers","active","initWanfaLabel","onGameBeign","audioMgr","playBGM","addEscEvent","node","gameChild","getChildByName","getComponent","Label","string","gameNetMgr","numOfMJ","numOfGames","maxNumOfGames","myselfChild","myholds","_chupaidrag","i","children","length","sprite","Sprite","push","spriteFrame","initDragStuffs","sides","side","sideChild","Animation","opt","data","opts","hideOptions","hideChupai","start","checkIp","gamestate","selfData","getSelfData","ipMap","seats","seatData","ip","userid","name","k","d","str","join","alert","show","on","EventType","TOUCH_START","event","console","log","turn","seatIndex","interactable","Button","opacity","x","getLocationX","width","y","getLocationY","height","bind","TOUCH_MOVE","Math","abs","getDeltaX","getDeltaY","scaleX","scaleY","TOUCH_END","shoot","mjId","TOUCH_CANCEL","dataEventHandler","self","initMahjongs","checkQueYiMen","last","initMopai","replayMgr","isReplay","pai","localIndex","getLocalIndex","index","setSpriteFrameByMJID","showAction","seatindex","hupai","hued","conf","initHupai","iszimo","holds","pop","initOtherMahjongs","mahjongmgr","getSpriteFrameByMJID","playEfx","playSFX","showChupai","audioUrl","getAudioURLByMJID","gangtype","chupai","addOption","btnName","childrenCount","child","btn","hu","gang","peng","gangpai","gp","wanfa","find","getWanfa","hupailist","hupainode","pre","getFoldPre","play","j","huinfo","info","ishupai","nc","holdsEmpty","curaction","onMJClicked","isHuanSanZhang","emit","target","net","send","getMJIndex","getSide","lastIndex","getHoldsEmptySpriteFrame","initEmptySprites","getEmptySpriteFrame","game","sideRoot","sideHolds","num","pengs","angangs","diangangs","wangangs","idx","sortHolds","lasetIdx","mopai","l","dingque","sortMJ","lackingNum","mjid","hasQue","getMahjongType","ret","onOptionClicked","update","dt","onDestroy","clear"],"mappings":"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","file":"MJGame.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {        \r\n        gameRoot:{\r\n            default:null,\r\n            type:cc.Node\r\n        },\r\n        \r\n        prepareRoot:{\r\n            default:null,\r\n            type:cc.Node   \r\n        },\r\n        \r\n        _myMJArr:[],\r\n        _options:null,\r\n        _selectedMJ:null,\r\n        _chupaiSprite:[],\r\n        _mjcount:null,\r\n        _gamecount:null,\r\n        _hupaiTips:[],\r\n        _hupaiLists:[],\r\n        _playEfxs:[],\r\n        _opts:[],\r\n    },\r\n    \r\n    onLoad: function () {\r\n        cc.vv.utils.setFitSreenMode();\r\n        this.addComponent(\"NoticeTip\");\r\n        this.addComponent(\"GameOver\");\r\n        this.addComponent(\"DingQue\");\r\n        this.addComponent(\"PengGangs\");\r\n        this.addComponent(\"MJRoom\");\r\n        this.addComponent(\"TimePointer\");\r\n        this.addComponent(\"GameResult\");\r\n        this.addComponent(\"Chat\");\r\n        this.addComponent(\"Folds\");\r\n        this.addComponent(\"ReplayCtrl\");\r\n        this.addComponent(\"PopupMgr\");\r\n        this.addComponent(\"HuanSanZhang\");\r\n        this.addComponent(\"ReConnect\");\r\n        this.addComponent(\"Voice\");\r\n        this.addComponent(\"UserInfoShow\");\r\n        this.addComponent(\"Status\");\r\n        \r\n        this.initView();\r\n        this.initEventHandlers();\r\n        \r\n        this.gameRoot.active = false;\r\n        this.prepareRoot.active = true;\r\n        this.initWanfaLabel();\r\n        this.onGameBeign();\r\n        cc.vv.audioMgr.playBGM(\"bgFight.mp3\");\r\n        cc.vv.utils.addEscEvent(this.node);\r\n    },\r\n    \r\n    initView:function(){\r\n        \r\n        //搜索需要的子节点\r\n        var gameChild = this.node.getChildByName(\"game\");\r\n        \r\n        this._mjcount = gameChild.getChildByName('mjcount').getComponent(cc.Label);\r\n        this._mjcount.string = \"剩余\" + cc.vv.gameNetMgr.numOfMJ + \"张\";\r\n        this._gamecount = gameChild.getChildByName('gamecount').getComponent(cc.Label);\r\n        this._gamecount.string = \"\" + cc.vv.gameNetMgr.numOfGames + \"/\" + cc.vv.gameNetMgr.maxNumOfGames + \"局\";\r\n\r\n        var myselfChild = gameChild.getChildByName(\"myself\");\r\n        var myholds = myselfChild.getChildByName(\"holds\");\r\n\r\n        this._chupaidrag = gameChild.getChildByName('chupaidrag');\r\n        this._chupaidrag.active = false;\r\n        \r\n        for(var i = 0; i < myholds.children.length; ++i){\r\n            var sprite = myholds.children[i].getComponent(cc.Sprite);\r\n            this._myMJArr.push(sprite);\r\n            sprite.spriteFrame = null;\r\n            this.initDragStuffs(sprite.node);\r\n        }\r\n        \r\n        //var realwidth = this.node.width;\r\n        //myholds.scaleX *= realwidth/1280;\r\n        //myholds.scaleY *= realwidth/1280;  \r\n        \r\n        var sides = [\"myself\",\"right\",\"up\",\"left\"];\r\n        for(var i = 0; i < sides.length; ++i){\r\n            var side = sides[i];\r\n            \r\n            var sideChild = gameChild.getChildByName(side);\r\n            this._hupaiTips.push(sideChild.getChildByName(\"HuPai\"));\r\n            this._hupaiLists.push(sideChild.getChildByName(\"hupailist\"));\r\n            this._playEfxs.push(sideChild.getChildByName(\"play_efx\").getComponent(cc.Animation));\r\n            this._chupaiSprite.push(sideChild.getChildByName(\"ChuPai\").children[0].getComponent(cc.Sprite));\r\n            \r\n            var opt = sideChild.getChildByName(\"opt\");\r\n            opt.active = false;\r\n            var sprite = opt.getChildByName(\"pai\").getComponent(cc.Sprite);\r\n            var data = {\r\n                node:opt,\r\n                sprite:sprite\r\n            };\r\n            this._opts.push(data);\r\n        }\r\n        \r\n        var opts = gameChild.getChildByName(\"ops\");\r\n        this._options = opts;\r\n        this.hideOptions();\r\n        this.hideChupai();\r\n    },\r\n\r\n    start:function(){\r\n        this.checkIp();\r\n    },\r\n\r\n    checkIp:function(){\r\n        if(cc.vv.gameNetMgr.gamestate == ''){\r\n            return;\r\n        }\r\n        var selfData = cc.vv.gameNetMgr.getSelfData();\r\n        var ipMap = {}\r\n        for(var i = 0; i < cc.vv.gameNetMgr.seats.length; ++i){\r\n            var seatData = cc.vv.gameNetMgr.seats[i];\r\n            if(seatData.ip != null && seatData.userid > 0 && seatData != selfData){\r\n                if(ipMap[seatData.ip]){\r\n                    ipMap[seatData.ip].push(seatData.name);\r\n                }\r\n                else{\r\n                    ipMap[seatData.ip] = [seatData.name];\r\n                }\r\n            }\r\n        }\r\n        \r\n        for(var k in ipMap){\r\n            var d = ipMap[k];\r\n            if(d.length >= 2){\r\n                var str = \"\" + d.join(\"\\n\") + \"\\n\\n正在使用同一IP地址进行游戏!\";\r\n                cc.vv.alert.show(\"注意\",str);\r\n                return; \r\n            }\r\n        }\r\n    },\r\n\r\n    initDragStuffs: function (node) {\r\n        //break if it's not my turn.\r\n        node.on(cc.Node.EventType.TOUCH_START, function (event) {\r\n            console.log(\"cc.Node.EventType.TOUCH_START\");\r\n            if (cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex) {\r\n                return;\r\n            }\r\n            node.interactable = node.getComponent(cc.Button).interactable;\r\n            if (!node.interactable) {\r\n                return;\r\n            }\r\n            node.opacity = 255;\r\n            this._chupaidrag.active = false;\r\n            this._chupaidrag.getComponent(cc.Sprite).spriteFrame = node.getComponent(cc.Sprite).spriteFrame;\r\n            this._chupaidrag.x = event.getLocationX() - this.node.width / 2;\r\n            this._chupaidrag.y = event.getLocationY() - this.node.height / 2;\r\n        }.bind(this));\r\n\r\n        node.on(cc.Node.EventType.TOUCH_MOVE, function (event) {\r\n            console.log(\"cc.Node.EventType.TOUCH_MOVE\");\r\n            if (cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex) {\r\n                return;\r\n            }\r\n            if (!node.interactable) {\r\n                return;\r\n            }\r\n            if (Math.abs(event.getDeltaX()) + Math.abs(event.getDeltaY()) < 0.5) {\r\n                return;\r\n            }\r\n            this._chupaidrag.active = true;\r\n            node.opacity = 150;\r\n            this._chupaidrag.opacity = 255;\r\n            this._chupaidrag.scaleX = 1;\r\n            this._chupaidrag.scaleY = 1;\r\n            this._chupaidrag.x = event.getLocationX() - this.width / 2;\r\n            this._chupaidrag.y = event.getLocationY() - this.height / 2;\r\n            node.y = 0;\r\n        }.bind(this));\r\n\r\n        node.on(cc.Node.EventType.TOUCH_END, function (event) {\r\n            if (cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex) {\r\n                return;\r\n            }\r\n            if (!node.interactable) {\r\n                return;\r\n            }\r\n            console.log(\"cc.Node.EventType.TOUCH_END\");\r\n            this._chupaidrag.active = false;\r\n            node.opacity = 255;\r\n            if (event.getLocationY() >= 200) {\r\n                this.shoot(node.mjId);\r\n            }\r\n        }.bind(this));\r\n\r\n        node.on(cc.Node.EventType.TOUCH_CANCEL, function (event) {\r\n            if (cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex) {\r\n                return;\r\n            }\r\n            if (!node.interactable) {\r\n                return;\r\n            }\r\n            console.log(\"cc.Node.EventType.TOUCH_CANCEL\");\r\n            this._chupaidrag.active = false;\r\n            node.opacity = 255;\r\n            if (event.getLocationY() >= 200) {\r\n                this.shoot(node.mjId);\r\n            } else if (event.getLocationY() >= 150) {\r\n                //this._huadongtishi.active = true;\r\n                //this._huadongtishi.getComponent(cc.Animation).play('huadongtishi');\r\n            }\r\n        }.bind(this));\r\n    },\r\n    \r\n    hideChupai:function(){\r\n        for(var i = 0; i < this._chupaiSprite.length; ++i){\r\n            this._chupaiSprite[i].node.active = false;\r\n        }        \r\n    },\r\n    \r\n    initEventHandlers:function(){\r\n        cc.vv.gameNetMgr.dataEventHandler = this.node;\r\n        \r\n        //初始化事件监听器\r\n        var self = this;\r\n        \r\n        this.node.on('game_holds',function(data){\r\n           self.initMahjongs();\r\n           self.checkQueYiMen();\r\n        });\r\n        \r\n        this.node.on('game_begin',function(data){\r\n            self.onGameBeign();\r\n            //第一把开局，要提示\r\n            if(cc.vv.gameNetMgr.numOfGames == 1){\r\n                self.checkIp();\r\n            }\r\n        });\r\n        \r\n        this.node.on('check_ip',function(data){\r\n            self.checkIp();\r\n        });\r\n        \r\n        this.node.on('game_sync',function(data){\r\n            self.onGameBeign();\r\n            self.checkIp();\r\n        });\r\n        \r\n        this.node.on('game_chupai',function(data){\r\n            self.hideChupai();\r\n            self.checkQueYiMen();\r\n            if(data.last != cc.vv.gameNetMgr.seatIndex){\r\n                self.initMopai(data.last,null);   \r\n            }\r\n            if(!cc.vv.replayMgr.isReplay() && data.turn != cc.vv.gameNetMgr.seatIndex){\r\n                self.initMopai(data.turn,-1);\r\n            }\r\n        });\r\n        \r\n        this.node.on('game_mopai',function(data){\r\n            self.hideChupai();\r\n            var pai = data.pai;\r\n            var localIndex = cc.vv.gameNetMgr.getLocalIndex(data.seatIndex);\r\n            if(localIndex == 0){\r\n                var index = 13;\r\n                var sprite = self._myMJArr[index];\r\n                self.setSpriteFrameByMJID(\"M_\",sprite,pai,index);\r\n                sprite.node.mjId = pai;                \r\n            }\r\n            else if(cc.vv.replayMgr.isReplay()){\r\n                self.initMopai(data.seatIndex,pai);\r\n            }\r\n        });\r\n        \r\n        this.node.on('game_action',function(data){\r\n            self.showAction(data);\r\n        });\r\n        \r\n        this.node.on('hupai',function(data){\r\n            //如果不是玩家自己，则将玩家的牌都放倒\r\n            var seatIndex = data.seatindex;\r\n            var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatIndex);\r\n            var hupai = self._hupaiTips[localIndex];\r\n            hupai.active = true;\r\n            \r\n            if(localIndex == 0){\r\n                self.hideOptions();\r\n            }\r\n            var seatData = cc.vv.gameNetMgr.seats[seatIndex];\r\n            seatData.hued = true;\r\n            if(cc.vv.gameNetMgr.conf.type == \"xlch\"){\r\n                hupai.getChildByName(\"sprHu\").active = true;\r\n                hupai.getChildByName(\"sprZimo\").active = false;\r\n                self.initHupai(localIndex,data.hupai);\r\n                if(data.iszimo){\r\n                    if(seatData.seatindex == cc.vv.gameNetMgr.seatIndex){\r\n                        seatData.holds.pop();\r\n                        self.initMahjongs();                \r\n                    }\r\n                    else{\r\n                        self.initOtherMahjongs(seatData);\r\n                    }\r\n                } \r\n            }\r\n            else{\r\n                hupai.getChildByName(\"sprHu\").active = !data.iszimo;\r\n                hupai.getChildByName(\"sprZimo\").active = data.iszimo;\r\n                \r\n                if(!(data.iszimo && localIndex==0))\r\n                {\r\n                    //if(cc.vv.replayMgr.isReplay() == false && localIndex != 0){\r\n                    //    self.initEmptySprites(seatIndex);                \r\n                    //}\r\n                    self.initMopai(seatIndex,data.hupai);\r\n                }                                         \r\n            }\r\n            \r\n            if(cc.vv.replayMgr.isReplay() == true && cc.vv.gameNetMgr.conf.type != \"xlch\"){\r\n                var opt = self._opts[localIndex];\r\n                opt.node.active = true;\r\n                opt.sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(\"M_\",data.hupai);                \r\n            }\r\n            \r\n            if(data.iszimo){\r\n                self.playEfx(localIndex,\"play_zimo\");    \r\n            }\r\n            else{\r\n                self.playEfx(localIndex,\"play_hu\");\r\n            }\r\n            \r\n            cc.vv.audioMgr.playSFX(\"nv/hu.mp3\");\r\n        });\r\n        \r\n        this.node.on('mj_count',function(data){\r\n            self._mjcount.string = \"剩余\" + cc.vv.gameNetMgr.numOfMJ + \"张\";\r\n        });\r\n        \r\n        this.node.on('game_num',function(data){\r\n            self._gamecount.string = \"\" + cc.vv.gameNetMgr.numOfGames + \"/\" + cc.vv.gameNetMgr.maxNumOfGames + \"局\";\r\n        });\r\n        \r\n        this.node.on('game_over',function(data){\r\n            self.gameRoot.active = false;\r\n            self.prepareRoot.active = true;\r\n        });\r\n        \r\n        \r\n        this.node.on('game_chupai_notify',function(data){\r\n            self.hideChupai();\r\n            var seatData = data.seatData;\r\n            //如果是自己，则刷新手牌\r\n            if(seatData.seatindex == cc.vv.gameNetMgr.seatIndex){\r\n                self.initMahjongs();                \r\n            }\r\n            else{\r\n                self.initOtherMahjongs(seatData);\r\n            }\r\n            self.showChupai();\r\n            var audioUrl = cc.vv.mahjongmgr.getAudioURLByMJID(data.pai);\r\n            cc.vv.audioMgr.playSFX(audioUrl);\r\n        });\r\n        \r\n        this.node.on('guo_notify',function(data){\r\n            self.hideChupai();\r\n            self.hideOptions();\r\n            var seatData = data;\r\n            //如果是自己，则刷新手牌\r\n            if(seatData.seatindex == cc.vv.gameNetMgr.seatIndex){\r\n                self.initMahjongs();                \r\n            }\r\n            cc.vv.audioMgr.playSFX(\"give.mp3\");\r\n        });\r\n        \r\n        this.node.on('guo_result',function(data){\r\n            self.hideOptions();\r\n        });\r\n        \r\n        this.node.on('game_dingque_finish',function(data){\r\n            self.initMahjongs();\r\n        });\r\n        \r\n        this.node.on('peng_notify',function(data){    \r\n            self.hideChupai();\r\n            \r\n            var seatData = data;\r\n            if(seatData.seatindex == cc.vv.gameNetMgr.seatIndex){\r\n                self.initMahjongs();                \r\n            }\r\n            else{\r\n                self.initOtherMahjongs(seatData);\r\n            }\r\n            var localIndex = self.getLocalIndex(seatData.seatindex);\r\n            self.playEfx(localIndex,\"play_peng\");\r\n            cc.vv.audioMgr.playSFX(\"nv/peng.mp3\");\r\n            self.hideOptions();\r\n        });\r\n        \r\n        this.node.on('gang_notify',function(data){\r\n            self.hideChupai();\r\n            var seatData = data.seatData;\r\n            var gangtype = data.gangtype;\r\n            if(seatData.seatindex == cc.vv.gameNetMgr.seatIndex){\r\n                self.initMahjongs();                \r\n            }\r\n            else{\r\n                self.initOtherMahjongs(seatData);\r\n            }\r\n            \r\n            var localIndex = self.getLocalIndex(seatData.seatindex);\r\n            if(gangtype == \"wangang\"){\r\n                self.playEfx(localIndex,\"play_guafeng\");\r\n                cc.vv.audioMgr.playSFX(\"guafeng.mp3\");\r\n            }\r\n            else{\r\n                self.playEfx(localIndex,\"play_xiayu\");\r\n                cc.vv.audioMgr.playSFX(\"rain.mp3\");\r\n            }\r\n        });\r\n        \r\n        this.node.on(\"hangang_notify\",function(data){\r\n            var localIndex = self.getLocalIndex(data);\r\n            self.playEfx(localIndex,\"play_gang\");\r\n            cc.vv.audioMgr.playSFX(\"nv/gang.mp3\");\r\n            self.hideOptions();\r\n        });\r\n\r\n        this.node.on('login_result', function () {\r\n            self.gameRoot.active = false;\r\n            self.prepareRoot.active = true;\r\n            console.log('login_result');\r\n        });\r\n    },\r\n    \r\n    showChupai:function(){\r\n        var pai = cc.vv.gameNetMgr.chupai; \r\n        if( pai >= 0 ){\r\n            //\r\n            var localIndex = this.getLocalIndex(cc.vv.gameNetMgr.turn);\r\n            var sprite = this._chupaiSprite[localIndex];\r\n            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(\"M_\",pai);\r\n            sprite.node.active = true;   \r\n        }\r\n    },\r\n    \r\n    addOption:function(btnName,pai){\r\n        for(var i = 0; i < this._options.childrenCount; ++i){\r\n            var child = this._options.children[i]; \r\n            if(child.name == \"op\" && child.active == false){\r\n                child.active = true;\r\n                var sprite = child.getChildByName(\"opTarget\").getComponent(cc.Sprite);\r\n                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(\"M_\",pai);\r\n                var btn = child.getChildByName(btnName); \r\n                btn.active = true;\r\n                btn.pai = pai;\r\n                return;\r\n            }\r\n        }\r\n    },\r\n    \r\n    hideOptions:function(data){\r\n        this._options.active = false;\r\n        for(var i = 0; i < this._options.childrenCount; ++i){\r\n            var child = this._options.children[i]; \r\n            if(child.name == \"op\"){\r\n                child.active = false;\r\n                child.getChildByName(\"btnPeng\").active = false;\r\n                child.getChildByName(\"btnGang\").active = false;\r\n                child.getChildByName(\"btnHu\").active = false;\r\n            }\r\n        }\r\n    },\r\n    \r\n    showAction:function(data){\r\n        if(this._options.active){\r\n            this.hideOptions();\r\n        }\r\n        \r\n        if(data && (data.hu || data.gang || data.peng)){\r\n            this._options.active = true;\r\n            if(data.hu){\r\n                this.addOption(\"btnHu\",data.pai);\r\n            }\r\n            if(data.peng){\r\n                this.addOption(\"btnPeng\",data.pai);\r\n            }\r\n            \r\n            if(data.gang){\r\n                for(var i = 0; i < data.gangpai.length;++i){\r\n                    var gp = data.gangpai[i];\r\n                    this.addOption(\"btnGang\",gp);\r\n                }\r\n            }   \r\n        }\r\n    },\r\n    \r\n    initWanfaLabel:function(){\r\n        var wanfa = cc.find(\"Canvas/infobar/wanfa\").getComponent(cc.Label);\r\n        wanfa.string = cc.vv.gameNetMgr.getWanfa();\r\n    },\r\n    \r\n    initHupai:function(localIndex,pai){\r\n        if(cc.vv.gameNetMgr.conf.type == \"xlch\"){\r\n            var hupailist = this._hupaiLists[localIndex];\r\n            for(var i = 0; i < hupailist.children.length; ++i){\r\n                var hupainode = hupailist.children[i]; \r\n                if(hupainode.active == false){\r\n                    var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);\r\n                    hupainode.getComponent(cc.Sprite).spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre,pai);\r\n                    hupainode.active = true;\r\n                    break;\r\n                }\r\n            }   \r\n        }\r\n    },\r\n    \r\n    playEfx:function(index,name){\r\n        this._playEfxs[index].node.active = true;\r\n        this._playEfxs[index].play(name);\r\n    },\r\n    \r\n    onGameBeign:function(){\r\n        \r\n        for(var i = 0; i < this._playEfxs.length; ++i){\r\n            this._playEfxs[i].node.active = false;\r\n        }\r\n        \r\n        for(var i = 0; i < this._hupaiLists.length; ++i){\r\n            for(var j = 0; j < this._hupaiLists[i].childrenCount; ++j){\r\n                this._hupaiLists[i].children[j].active = false;\r\n            }\r\n        }\r\n        \r\n        for(var i = 0; i < cc.vv.gameNetMgr.seats.length; ++i){\r\n            var seatData = cc.vv.gameNetMgr.seats[i];\r\n            var localIndex = cc.vv.gameNetMgr.getLocalIndex(i);        \r\n            var hupai = this._hupaiTips[localIndex];\r\n            hupai.active = seatData.hued;\r\n            if(seatData.hued){\r\n                hupai.getChildByName(\"sprHu\").active = !seatData.iszimo;\r\n                hupai.getChildByName(\"sprZimo\").active = seatData.iszimo;\r\n            }\r\n            \r\n            if(seatData.huinfo){\r\n                for(var j = 0; j < seatData.huinfo.length; ++j){\r\n                    var info = seatData.huinfo[j];\r\n                    if(info.ishupai){\r\n                        this.initHupai(localIndex,info.pai);    \r\n                    }\r\n                }\r\n            }\r\n        }\r\n        \r\n        this.hideChupai();\r\n        this.hideOptions();\r\n        var sides = [\"right\",\"up\",\"left\"];        \r\n        var gameChild = this.node.getChildByName(\"game\");\r\n        for(var i = 0; i < sides.length; ++i){\r\n            var sideChild = gameChild.getChildByName(sides[i]);\r\n            var holds = sideChild.getChildByName(\"holds\");\r\n            for(var j = 0; j < holds.childrenCount; ++j){\r\n                var nc = holds.children[j];\r\n                nc.active = true;\r\n                nc.scaleX = 1.0;\r\n                nc.scaleY = 1.0;\r\n                var sprite = nc.getComponent(cc.Sprite); \r\n                sprite.spriteFrame = cc.vv.mahjongmgr.holdsEmpty[i+1];\r\n            }            \r\n        }\r\n      \r\n        if(cc.vv.gameNetMgr.gamestate == \"\" && cc.vv.replayMgr.isReplay() == false){\r\n            return;\r\n        }\r\n\r\n        this.gameRoot.active = true;\r\n        this.prepareRoot.active = false;\r\n        this.initMahjongs();\r\n        var seats = cc.vv.gameNetMgr.seats;\r\n        for(var i in seats){\r\n            var seatData = seats[i];\r\n            var localIndex = cc.vv.gameNetMgr.getLocalIndex(i);\r\n            if(localIndex != 0){\r\n                this.initOtherMahjongs(seatData);\r\n                if(i == cc.vv.gameNetMgr.turn){\r\n                    this.initMopai(i,-1);\r\n                }\r\n                else{\r\n                    this.initMopai(i,null);    \r\n                }\r\n            }\r\n        }\r\n        this.showChupai();\r\n        if(cc.vv.gameNetMgr.curaction != null){\r\n            this.showAction(cc.vv.gameNetMgr.curaction);\r\n            cc.vv.gameNetMgr.curaction = null;\r\n        }\r\n        \r\n        this.checkQueYiMen();\r\n    },\r\n    \r\n    onMJClicked:function(event){\r\n        if(cc.vv.gameNetMgr.isHuanSanZhang){\r\n            this.node.emit(\"mj_clicked\",event.target);\r\n            return;\r\n        }\r\n        \r\n        //如果不是自己的轮子，则忽略\r\n        if(cc.vv.gameNetMgr.turn != cc.vv.gameNetMgr.seatIndex){\r\n            console.log(\"not your turn.\" + cc.vv.gameNetMgr.turn);\r\n            return;\r\n        }\r\n        \r\n        for(var i = 0; i < this._myMJArr.length; ++i){\r\n            if(event.target == this._myMJArr[i].node){\r\n                //如果是再次点击，则出牌\r\n                if(event.target == this._selectedMJ){\r\n                    this.shoot(this._selectedMJ.mjId); \r\n                    this._selectedMJ.y = 0;\r\n                    this._selectedMJ = null;\r\n                    return;\r\n                }\r\n                if(this._selectedMJ != null){\r\n                    this._selectedMJ.y = 0;\r\n                }\r\n                event.target.y = 15;\r\n                this._selectedMJ = event.target;\r\n                return;\r\n            }\r\n        }\r\n    },\r\n    \r\n    //出牌\r\n    shoot:function(mjId){\r\n        if(mjId == null){\r\n            return;\r\n        }\r\n        cc.vv.net.send('chupai',mjId);\r\n    },\r\n    \r\n    getMJIndex:function(side,index){\r\n        if(side == \"right\" || side == \"up\"){\r\n            return 13 - index;\r\n        }\r\n        return index;\r\n    },\r\n    \r\n    initMopai:function(seatIndex,pai){\r\n        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatIndex);\r\n        var side = cc.vv.mahjongmgr.getSide(localIndex);\r\n        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);\r\n        \r\n        var gameChild = this.node.getChildByName(\"game\");\r\n        var sideChild = gameChild.getChildByName(side);\r\n        var holds = sideChild.getChildByName(\"holds\");\r\n\r\n        var lastIndex = this.getMJIndex(side,13);\r\n        var nc = holds.children[lastIndex];\r\n\r\n        nc.scaleX = 1.0;\r\n        nc.scaleY = 1.0;\r\n                        \r\n        if(pai == null){\r\n            nc.active = false;\r\n        }\r\n        else if(pai >= 0){\r\n            nc.active = true;\r\n            if(side == \"up\"){\r\n                nc.scaleX = 0.73;\r\n                nc.scaleY = 0.73;                    \r\n            }\r\n            var sprite = nc.getComponent(cc.Sprite); \r\n            sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre,pai);\r\n        }\r\n        else if(pai != null){\r\n            nc.active = true;\r\n            if(side == \"up\"){\r\n                nc.scaleX = 1.0;\r\n                nc.scaleY = 1.0;                    \r\n            }\r\n            var sprite = nc.getComponent(cc.Sprite); \r\n            sprite.spriteFrame = cc.vv.mahjongmgr.getHoldsEmptySpriteFrame(side);\r\n        }\r\n    },\r\n    \r\n    initEmptySprites:function(seatIndex){\r\n        var localIndex = cc.vv.gameNetMgr.getLocalIndex(seatIndex);\r\n        var side = cc.vv.mahjongmgr.getSide(localIndex);\r\n        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);\r\n        \r\n        var gameChild = this.node.getChildByName(\"game\");\r\n        var sideChild = gameChild.getChildByName(side);\r\n        var holds = sideChild.getChildByName(\"holds\");\r\n        var spriteFrame = cc.vv.mahjongmgr.getEmptySpriteFrame(side);\r\n        for(var i = 0; i < holds.childrenCount; ++i){\r\n            var nc = holds.children[i];\r\n            nc.scaleX = 1.0;\r\n            nc.scaleY = 1.0;\r\n            \r\n            var sprite = nc.getComponent(cc.Sprite); \r\n            sprite.spriteFrame = spriteFrame;\r\n        }\r\n    },\r\n    \r\n    initOtherMahjongs:function(seatData){\r\n        //console.log(\"seat:\" + seatData.seatindex);\r\n        var localIndex = this.getLocalIndex(seatData.seatindex);\r\n        if(localIndex == 0){\r\n            return;\r\n        }\r\n        var side = cc.vv.mahjongmgr.getSide(localIndex);\r\n        var game = this.node.getChildByName(\"game\");\r\n        var sideRoot = game.getChildByName(side);\r\n        var sideHolds = sideRoot.getChildByName(\"holds\");\r\n        var num = seatData.pengs.length + seatData.angangs.length + seatData.diangangs.length + seatData.wangangs.length;\r\n        num *= 3;\r\n        for(var i = 0; i < num; ++i){\r\n            var idx = this.getMJIndex(side,i);\r\n            sideHolds.children[idx].active = false;\r\n        }\r\n        \r\n        var pre = cc.vv.mahjongmgr.getFoldPre(localIndex);\r\n        var holds = this.sortHolds(seatData);\r\n        if(holds != null && holds.length > 0){\r\n            for(var i = 0; i < holds.length; ++i){\r\n                var idx = this.getMJIndex(side,i + num);\r\n                var sprite = sideHolds.children[idx].getComponent(cc.Sprite); \r\n                if(side == \"up\"){\r\n                    sprite.node.scaleX = 0.73;\r\n                    sprite.node.scaleY = 0.73;                    \r\n                }\r\n                sprite.node.active = true;\r\n                sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre,holds[i]);\r\n            }\r\n            \r\n            if(holds.length + num == 13){\r\n                var lasetIdx = this.getMJIndex(side,13);\r\n                sideHolds.children[lasetIdx].active = false;\r\n            }\r\n        }\r\n    },\r\n    \r\n    sortHolds:function(seatData){\r\n        var holds = seatData.holds;\r\n        if(holds == null){\r\n            return null;\r\n        }\r\n        //如果手上的牌的数目是2,5,8,11,14，表示最后一张牌是刚摸到的牌\r\n        var mopai = null;\r\n        var l = holds.length \r\n        if( l == 2 || l == 5 || l == 8 || l == 11 || l == 14){\r\n            mopai = holds.pop();\r\n        }\r\n        \r\n        var dingque = seatData.dingque;\r\n        cc.vv.mahjongmgr.sortMJ(holds,dingque);\r\n        \r\n        //将摸牌添加到最后\r\n        if(mopai != null){\r\n            holds.push(mopai);\r\n        }\r\n        return holds;\r\n    },\r\n    \r\n    initMahjongs:function(){\r\n        var seats = cc.vv.gameNetMgr.seats;\r\n        var seatData = seats[cc.vv.gameNetMgr.seatIndex];\r\n        var holds = this.sortHolds(seatData);\r\n        if(holds == null){\r\n            return;\r\n        }\r\n        \r\n        //初始化手牌\r\n        var lackingNum = (seatData.pengs.length + seatData.angangs.length + seatData.diangangs.length + seatData.wangangs.length)*3;\r\n        for(var i = 0; i < holds.length; ++i){\r\n            var mjid = holds[i];\r\n            var sprite = this._myMJArr[i + lackingNum];\r\n            sprite.node.mjId = mjid;\r\n            sprite.node.y = 0;\r\n            this.setSpriteFrameByMJID(\"M_\",sprite,mjid);\r\n        }\r\n        for(var i = 0; i < lackingNum; ++i){\r\n            var sprite = this._myMJArr[i]; \r\n            sprite.node.mjId = null;\r\n            sprite.spriteFrame = null;\r\n            sprite.node.active = false;\r\n        }\r\n        for(var i = lackingNum + holds.length; i < this._myMJArr.length; ++i){\r\n            var sprite = this._myMJArr[i]; \r\n            sprite.node.mjId = null;\r\n            sprite.spriteFrame = null;\r\n            sprite.node.active = false;            \r\n        }\r\n    },\r\n    \r\n    setSpriteFrameByMJID:function(pre,sprite,mjid){\r\n        sprite.spriteFrame = cc.vv.mahjongmgr.getSpriteFrameByMJID(pre,mjid);\r\n        sprite.node.active = true;\r\n    },\r\n    \r\n    //如果玩家手上还有缺的牌没有打，则只能打缺牌\r\n    checkQueYiMen:function(){\r\n        if(cc.vv.gameNetMgr.conf==null || cc.vv.gameNetMgr.conf.type != \"xlch\" || !cc.vv.gameNetMgr.getSelfData().hued){\r\n            //遍历检查看是否有未打缺的牌 如果有，则需要将不是定缺的牌设置为不可用\r\n            var dingque = cc.vv.gameNetMgr.dingque;\r\n    //        console.log(dingque)\r\n            var hasQue = false;\r\n            if(cc.vv.gameNetMgr.seatIndex == cc.vv.gameNetMgr.turn){\r\n                for(var i = 0; i < this._myMJArr.length; ++i){\r\n                    var sprite = this._myMJArr[i];\r\n    //                console.log(\"sprite.node.mjId:\" + sprite.node.mjId);\r\n                    if(sprite.node.mjId != null){\r\n                        var type = cc.vv.mahjongmgr.getMahjongType(sprite.node.mjId);\r\n                        if(type == dingque){\r\n                            hasQue = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                }            \r\n            }\r\n\r\n    //        console.log(\"hasQue:\" + hasQue);\r\n            for(var i = 0; i < this._myMJArr.length; ++i){\r\n                var sprite = this._myMJArr[i];\r\n                if(sprite.node.mjId != null){\r\n                    var type = cc.vv.mahjongmgr.getMahjongType(sprite.node.mjId);\r\n                    if(hasQue && type != dingque){\r\n                        sprite.node.getComponent(cc.Button).interactable = false;\r\n                    }\r\n                    else{\r\n                        sprite.node.getComponent(cc.Button).interactable = true;\r\n                    }\r\n                }\r\n            }   \r\n        }\r\n        else{\r\n            if(cc.vv.gameNetMgr.seatIndex == cc.vv.gameNetMgr.turn){\r\n                for(var i = 0; i < 14; ++i){\r\n                    var sprite = this._myMJArr[i]; \r\n                    if(sprite.node.active == true){\r\n                        sprite.node.getComponent(cc.Button).interactable = i == 13;\r\n                    }\r\n                }\r\n            }\r\n            else{\r\n                for(var i = 0; i < 14; ++i){\r\n                    var sprite = this._myMJArr[i]; \r\n                    if(sprite.node.active == true){\r\n                        sprite.node.getComponent(cc.Button).interactable = true;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    \r\n    getLocalIndex:function(index){\r\n        var ret = (index - cc.vv.gameNetMgr.seatIndex + 4) % 4;\r\n        //console.log(\"old:\" + index + \",base:\" + cc.vv.gameNetMgr.seatIndex + \",new:\" + ret);\r\n        return ret;\r\n    },\r\n    \r\n    onOptionClicked:function(event){\r\n        console.log(event.target.pai);\r\n        if(event.target.name == \"btnPeng\"){\r\n            cc.vv.net.send(\"peng\");\r\n        }\r\n        else if(event.target.name == \"btnGang\"){\r\n            cc.vv.net.send(\"gang\",event.target.pai);\r\n        }\r\n        else if(event.target.name == \"btnHu\"){\r\n            cc.vv.net.send(\"hu\");\r\n        }\r\n        else if(event.target.name == \"btnGuo\"){\r\n            cc.vv.net.send(\"guo\");\r\n        }\r\n    },\r\n    \r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n    },\r\n    \r\n    onDestroy:function(){\r\n        console.log(\"onDestroy\");\r\n        if(cc.vv){\r\n            cc.vv.gameNetMgr.clear();   \r\n        }\r\n    }\r\n});\r\n"]}
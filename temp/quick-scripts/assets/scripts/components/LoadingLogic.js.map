{"version":3,"sources":["LoadingLogic.js"],"names":["cc","Class","extends","Component","properties","tipLabel","Label","_stateStr","_progress","_splash","_isLoading","onLoad","vv","utils","setFitSreenMode","string","startPreloading","self","onProgress","completedCount","totalCount","item","onLoadComplete","director","loadScene","update","dt","length","Math","floor","t","Date","now","i"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,kBAASL,GAAGM,KADJ;AAERC,mBAAU,EAFF;AAGRC,mBAAU,GAHF;AAIRC,iBAAQ,IAJA;AAKRC,oBAAW;AALH,KAHP;;AAWL;AACAC,YAAQ,kBAAY;AAChBX,WAAGY,EAAH,CAAMC,KAAN,CAAYC,eAAZ;AACA,aAAKT,QAAL,CAAcU,MAAd,GAAuB,KAAKR,SAA5B;AACA,aAAKS,eAAL;AACH,KAhBI;;AAkBLA,qBAAgB,2BAAU;AACtB,aAAKT,SAAL,GAAiB,YAAjB;AACA,aAAKG,UAAL,GAAkB,IAAlB;AACA,YAAIO,OAAO,IAAX;;AAEA,YAAIC,aAAa,SAAbA,UAAa,CAAWC,cAAX,EAA2BC,UAA3B,EAAwCC,IAAxC,EAA8C;AAC3D;AACA,gBAAGJ,KAAKP,UAAR,EAAmB;AACfO,qBAAKT,SAAL,GAAiBW,iBAAeC,UAAhC;AACH;AACJ,SALD;;AAOA;AACA;AACA;AACAH,aAAKK,cAAL;AACH,KAlCI;;AAoCLA,oBAAe,0BAAU;AACrB,aAAKZ,UAAL,GAAkB,KAAlB;AACA,aAAKH,SAAL,GAAiB,MAAjB;AACAP,WAAGuB,QAAH,CAAYC,SAAZ,CAAsB,OAAtB;AACH,KAxCI;;AA0CL;AACAC,YAAQ,gBAAUC,EAAV,EAAc;AAClB,YAAG,KAAKnB,SAAL,CAAeoB,MAAf,IAAyB,CAA5B,EAA8B;AAC1B;AACH;AACD,aAAKtB,QAAL,CAAcU,MAAd,GAAuB,KAAKR,SAAL,GAAiB,GAAxC;AACA,YAAG,KAAKG,UAAR,EAAmB;AACf,iBAAKL,QAAL,CAAcU,MAAd,IAAwBa,KAAKC,KAAL,CAAW,KAAKrB,SAAL,GAAiB,GAA5B,IAAmC,GAA3D;AACH,SAFD,MAGI;AACA,gBAAIsB,IAAIF,KAAKC,KAAL,CAAWE,KAAKC,GAAL,KAAa,IAAxB,IAAgC,CAAxC;AACA,iBAAI,IAAIC,IAAI,CAAZ,EAAeA,IAAIH,CAAnB,EAAsB,EAAGG,CAAzB,EAA2B;AACvB,qBAAK5B,QAAL,CAAcU,MAAd,IAAwB,GAAxB;AACH;AACJ;AACJ;AAzDI,CAAT","file":"LoadingLogic.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\components","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        tipLabel:cc.Label,\r\n        _stateStr:'',\r\n        _progress:0.0,\r\n        _splash:null,\r\n        _isLoading:false,\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n        cc.vv.utils.setFitSreenMode();\r\n        this.tipLabel.string = this._stateStr;\r\n        this.startPreloading();\r\n    },\r\n    \r\n    startPreloading:function(){\r\n        this._stateStr = \"正在加载资源，请稍候\"\r\n        this._isLoading = true;\r\n        var self = this;\r\n        \r\n        var onProgress = function ( completedCount, totalCount,  item ){\r\n            //console.log(\"completedCount:\" + completedCount + \",totalCount:\" + totalCount );\r\n            if(self._isLoading){\r\n                self._progress = completedCount/totalCount;\r\n            }\r\n        };\r\n        \r\n        //cc.loader.loadResDir(\"textures\",cc.Texture2D, onProgress,function (err, assets) {\r\n        //    self.onLoadComplete();\r\n        //});\r\n        self.onLoadComplete();      \r\n    },\r\n    \r\n    onLoadComplete:function(){\r\n        this._isLoading = false;\r\n        this._stateStr = \"准备登陆\";\r\n        cc.director.loadScene(\"login\");\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    update: function (dt) {\r\n        if(this._stateStr.length == 0){\r\n            return;\r\n        }\r\n        this.tipLabel.string = this._stateStr + ' ';\r\n        if(this._isLoading){\r\n            this.tipLabel.string += Math.floor(this._progress * 100) + \"%\";   \r\n        }\r\n        else{\r\n            var t = Math.floor(Date.now() / 1000) % 4;\r\n            for(var i = 0; i < t; ++ i){\r\n                this.tipLabel.string += '.';\r\n            }            \r\n        }\r\n    }\r\n});"]}